<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Feed</title>
<style>
body { margin:0; font-family: Arial, sans-serif; background:#f4f4f9; color:#222; }
.top-bar {display:flex;justify-content:space-between;align-items:center;background:#fff;padding:12px 24px;box-shadow:0 2px 4px rgba(0,0,0,.1);}
.logo {font-weight:bold;font-size:20px;}
.actions a {text-decoration:none;margin-left:12px;background:#007bff;color:#fff;padding:8px 16px;border-radius:4px;font-size:14px;}
.actions a.btn-logout {background:#dc3545;}
.actions a:hover {opacity:.85;}
.container {max-width:800px;margin:32px auto;padding:0 20px;}
.flash-messages ul {list-style:none;padding:0;margin:0 0 16px 0;}
.flash-messages li {background:#ffe9cc;border:1px solid #ffc372;padding:10px 14px;border-radius:4px;margin-bottom:6px;}
.new-post {background:#fff;padding:16px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.08);margin-bottom:24px;}
.new-post textarea {width:100%;min-height:90px;resize:vertical;padding:10px;border:1px solid #ccc;border-radius:4px;font-family:inherit;}
.new-post button {margin-top:10px;background:#28a745;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-size:14px;}
.new-post button:hover {background:#218838;}
.posts .post {background:#fff;padding:16px;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:18px;}
.post .meta {font-size:13px;color:#555;margin-bottom:8px;display:flex;justify-content:space-between;flex-wrap:wrap;}
.post .content {white-space:pre-wrap;line-height:1.4;}
.empty {text-align:center;color:#666;margin-top:40px;}
</style>
</head>
<body>
    <div class="top-bar">
        <div class="logo">OnlyFood</div>
        <div class="actions">
            <span class="welcome">{{ session.get('user_name', '') }}</span>
            <a href="/profile" class="btn-profile">Profile</a>
            <a href="/logout" class="btn-logout">Logout</a>
        </div>
    </div>

    <div class="container">
        <div class="flash-messages">
            {% with messages = get_flashed_messages() %}
              {% if messages %}
                <ul>
                  {% for m in messages %}
                    <li>{{ m }}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            {% endwith %}
        </div>

        <div class="new-post">
            <form action="/create_post" method="POST">
                <textarea name="content" placeholder="Write something..." required></textarea>
                <button type="submit">Post</button>
            </form>
        </div>

        <div class="posts">
            {% if posts %}
                {% for p in posts %}
                    <div class="post">
                        <div class="meta">
                            <strong>{{ p.author_name or p.name }} {{ p.author_lastname or p.lastname }}</strong>
                            <span class="date">{{ p.created_at }}</span>
                        </div>
                        <div class="content">{{ p.content }}</div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="empty">No posts yet.</p>
            {% endif %}
        </div>
    </div>
</body>
</html>